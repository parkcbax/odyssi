@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--app-font-family);
  --font-mono: var(--font-geist-mono);
  --font-jetbrains-mono: var(--font-jetbrains-mono);
  --font-fira-code: var(--font-fira-code);
  --font-roboto: var(--font-roboto);
  --font-lora: var(--font-lora);
  --font-kanit: var(--font-kanit);
  --font-prompt: var(--font-prompt);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);
  --radius-3xl: calc(var(--radius) + 12px);
  --radius-4xl: calc(var(--radius) + 16px);
  --color-gray-50: #f9fafb;
  --color-gray-100: #f3f4f6;
  --color-gray-200: #e5e7eb;
  --color-gray-300: #d1d5db;
  --color-gray-400: #9ca3af;
  --color-gray-500: #6b7280;
  --color-gray-600: #4b5563;
  --color-gray-700: #374151;
  --color-gray-800: #1f2937;
  --color-gray-900: #111827;
  --color-gray-950: #030712;
}

:root {
  --radius: 0.625rem;
  --background: #ffffff;
  --foreground: #09090b;
  --card: #ffffff;
  --card-foreground: #09090b;
  --popover: #ffffff;
  --popover-foreground: #09090b;
  --primary: #718982;
  --primary-foreground: #fafafa;
  --secondary: #f4f4f5;
  --secondary-foreground: #18181b;
  --muted: #f4f4f5;
  --muted-foreground: #71717a;
  --accent: #f4f4f5;
  --accent-foreground: #18181b;
  --destructive: #ef4444;
  --border: #e4e4e7;
  --input: #e4e4e7;
  --ring: #718982;
  --chart-1: #e76e50;
  --chart-2: #2a9d90;
  --chart-3: #274754;
  --chart-4: #e8c468;
  --chart-5: #f4a462;
  --sidebar: #f8f8f8;
  --sidebar-foreground: #09090b;
  --sidebar-primary: #718982;
  --sidebar-primary-foreground: #fafafa;
  --sidebar-accent: #f4f4f5;
  --sidebar-accent-foreground: #18181b;
  --sidebar-border: #e4e4e7;
  --sidebar-ring: #718982;
  --app-font-family: var(--font-geist-sans), ui-sans-serif, system-ui, sans-serif;
}

[data-font="kanit"] {
  --app-font-family: var(--font-kanit), var(--font-geist-sans), ui-sans-serif, system-ui, sans-serif !important;
}

[data-font="prompt"] {
  --app-font-family: var(--font-prompt), var(--font-geist-sans), ui-sans-serif, system-ui, sans-serif !important;
}

[data-font="inter"] {
  --app-font-family: var(--font-geist-sans), ui-sans-serif, system-ui, sans-serif !important;
}

[data-font="roboto"] {
  --app-font-family: var(--font-roboto), var(--font-geist-sans), ui-sans-serif, system-ui, sans-serif !important;
}

.dark {
  --background: #09090b;
  --foreground: #fafafa;
  --card: #09090b;
  --card-foreground: #fafafa;
  --popover: #09090b;
  --popover-foreground: #fafafa;
  --primary: #718982;
  /* lighter indigo for dark mode */
  --primary-foreground: #fafafa;
  --secondary: #27272a;
  --secondary-foreground: #fafafa;
  --muted: #27272a;
  --muted-foreground: #a1a1aa;
  --accent: #27272a;
  --accent-foreground: #fafafa;
  --destructive: #7f1d1d;
  --border: #27272a;
  --input: #27272a;
  --ring: #718982;
  --chart-1: #2662d9;
  --chart-2: #e23670;
  --chart-3: #e88c30;
  --chart-4: #af57db;
  --chart-5: #2eb88a;
  --sidebar: #09090b;
  --sidebar-foreground: #fafafa;
  --sidebar-primary: #718982;
  --sidebar-primary-foreground: #fafafa;
  --sidebar-accent: #27272a;
  --sidebar-accent-foreground: #fafafa;
  --sidebar-border: #27272a;
  --sidebar-ring: #718982;
}

/* Custom Tiptap Link Styling */
.ProseMirror a,
.prose a {
  color: var(--primary) !important;
  text-decoration: none;
}

.ProseMirror a:hover,
.prose a:hover {
  text-decoration: underline;
}

@layer base {
  * {
    @apply border-border;
    outline-color: rgba(113, 137, 130, 0.5);
    /* Force RGBA to avoid okla/lab in computed style */
  }

  html,
  body {
    @apply bg-background text-foreground;
    overflow-wrap: anywhere;
    /* Prevent long words from causing overflow globally */
  }
}

/*
 * FOOLPROOF FONT ENFORCEMENT
 * We target elements that are NOT inside a code block.
 * This prevents global font settings from leaking into code.
 */
[data-font] *:not(.code-block *):not(pre *):not(code *):not(.font-preview):not(.font-preview *) {
  font-family: inherit !important;
}

/* Extra insurance for components that might break inheritance */
[data-font] .prose *:not(.code-block *):not(pre *):not(code *):not(.font-preview):not(.font-preview *),
[data-font] .ProseMirror *:not(.code-block *):not(pre *):not(code *):not(.font-preview):not(.font-preview *) {
  font-family: var(--app-font-family) !important;
}


/* Blog Font Configuration */
[data-blog-font="inter"] .prose,
[data-blog-font="inter"] .ProseMirror {
  --blog-font-family: var(--font-geist-sans), ui-sans-serif, sans-serif;
}

[data-blog-font="kanit"] .prose,
[data-blog-font="kanit"] .ProseMirror {
  --blog-font-family: var(--font-kanit), var(--font-geist-sans), ui-sans-serif, sans-serif;
}

[data-blog-font="prompt"] .prose,
[data-blog-font="prompt"] .ProseMirror {
  --blog-font-family: var(--font-prompt), var(--font-geist-sans), ui-sans-serif, sans-serif;
}

[data-blog-font="roboto"] .prose,
[data-blog-font="roboto"] .ProseMirror {
  --blog-font-family: var(--font-roboto), ui-sans-serif, sans-serif;
}

[data-blog-font="serif"] .prose,
[data-blog-font="serif"] .ProseMirror {
  --blog-font-family: var(--font-lora), ui-serif, Georgia, Cambria, serif;
}

[data-blog-font="mono"] .prose,
[data-blog-font="mono"] .ProseMirror {
  --blog-font-family: var(--font-geist-mono), ui-monospace, monospace;
}

[data-blog-font] .prose *:not(.code-block *):not(pre *):not(code *),
[data-blog-font] .ProseMirror *:not(.code-block *):not(pre *):not(code *) {
  font-family: var(--blog-font-family) !important;
}

/* Blog Size Configuration */
[data-blog-size="small"] .prose,
[data-blog-size="small"] .ProseMirror {
  font-size: 0.875rem !important;
  /* 14px */
}

[data-blog-size="medium"] .prose,
[data-blog-size="medium"] .ProseMirror {
  font-size: 1rem !important;
  /* 16px - tailwind default prose base */
}

[data-blog-size="large"] .prose,
[data-blog-size="large"] .ProseMirror {
  font-size: 1.125rem !important;
  /* 18px */
}

[data-blog-size="xl"] .prose,
[data-blog-size="xl"] .ProseMirror {
  font-size: 1.25rem !important;
  /* 20px */
}

/* Ensure headings scale relatively or stay readable */
[data-blog-size="large"] .prose h1,
[data-blog-size="xl"] .prose h1 {
  font-size: 2.5em !important;
}

/* ... etc, simplify for now, allowing prose to do its relative sizing based on base font size is usually best, 
   but tailwind prose sets hard pixels on elements sometimes. 
   Ideally we just set base size and let ems work, but prose class sets font-size on p, h1, etc specifically.
   We might need to override --tw-prose-body and similar variables if using tailwind typography v3.
   Let's try vars first which is cleaner if supported.
*/

[data-blog-size="small"] .prose,
[data-blog-size="small"] .ProseMirror,
[data-blog-size="small"] .prose p,
[data-blog-size="small"] .ProseMirror p {
  font-size: 0.875rem !important;
  line-height: 1.6 !important;
}

[data-blog-size="medium"] .prose,
[data-blog-size="medium"] .ProseMirror,
[data-blog-size="medium"] .prose p,
[data-blog-size="medium"] .ProseMirror p {
  font-size: 1.125rem !important;
  /* Bump default base to be more readable */
  line-height: 1.75 !important;
}

[data-blog-size="large"] .prose,
[data-blog-size="large"] .ProseMirror,
[data-blog-size="large"] .prose p,
[data-blog-size="large"] .ProseMirror p {
  font-size: 1.25rem !important;
  line-height: 1.8 !important;
}

[data-blog-size="xl"] .prose,
[data-blog-size="xl"] .ProseMirror,
[data-blog-size="xl"] .prose p,
[data-blog-size="xl"] .ProseMirror p {
  font-size: 1.5rem !important;
  line-height: 2 !important;
}


@media print {

  /* Explicitly hide the entire original app structure */
  body>*:not(#entry-printable-content-wrapper) {
    display: none !important;
  }

  /* Redundant hiding for safety */
  nav,
  aside,
  header,
  footer,
  button,
  .sidebar,
  div[data-radix-popper-content-wrapper],
  [role="dialog"] {
    display: none !important;
  }

  /* Ensure the wrapper is the ONLY thing visible */
  #entry-printable-content-wrapper {
    display: block !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: auto !important;
    z-index: 9999 !important;
    background-color: white !important;
  }

  /* Style the content inside the wrapper */
  #entry-printable-content {
    display: block !important;
    width: 100% !important;
    margin: 0 !important;
    padding: 20mm !important;
    background-color: white !important;
    color: black !important;
    box-shadow: none !important;
    border: none !important;
  }

  /* Hide any buttons that might have been cloned */
  #entry-printable-content button,
  #entry-printable-content .btn,
  #entry-printable-content [role="button"] {
    display: none !important;
  }

  /* Ensure text is black and background white */
  #entry-printable-content * {
    color: black !important;
    background-color: transparent !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
}

/* Code Block Syntax Highlighting */
.code-block {
  position: relative;
  margin: 1.5rem 0;
  border: 1px solid var(--border) !important;
  border-radius: 0.75rem !important;
  overflow: hidden !important;
}

.code-block pre {
  background: transparent !important;
  color: var(--foreground) !important;
  font-family: var(--font-geist-mono), ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
  padding: 1.25rem !important;
  overflow-x: auto !important;
  margin: 0 !important;
  border: none !important;
  border-radius: 0 !important;
}

.code-block pre code,
.code-block pre [data-node-view-content] {
  background: none !important;
  color: inherit !important;
  font-size: 0.875rem !important;
  padding: 0 !important;
  font-family: inherit !important;
  /* Inherit from pre */
}

.hljs-comment,
.hljs-quote {
  color: #71717a;
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-addition {
  color: #c678dd;
}

.hljs-number,
.hljs-string,
.hljs-meta .hljs-meta-string,
.hljs-literal,
.hljs-doctag,
.hljs-regexp {
  color: #98c379;
}

.hljs-title,
.hljs-section,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class {
  color: #61afef;
}

.hljs-variable,
.hljs-template-variable,
.hljs-class .hljs-title,
.hljs-type {
  color: #e5c07b;
}

.hljs-tag,
.hljs-symbol,
.hljs-bullet,
.hljs-subst,
.hljs-meta,
.hljs-link {
  color: #d19a66;
}

/* Code Block Font Configuration (Thematic Overrides) */
[data-code-font="geist"] .code-block pre,
[data-code-font="geist"] .code-block pre * {
  font-family: var(--font-geist-mono), ui-monospace, monospace !important;
}

[data-code-font="jetbrains"] .code-block pre,
[data-code-font="jetbrains"] .code-block pre * {
  font-family: var(--font-jetbrains-mono), ui-monospace, monospace !important;
}

[data-code-font="fira"] .code-block pre,
[data-code-font="fira"] .code-block pre * {
  font-family: var(--font-fira-code), ui-monospace, monospace !important;
}

.hljs-params,
.hljs-attr {
  color: #d19a66;
}

.hljs-attribute {
  color: #98c379;
}

.hljs-built_in,
.hljs-deletion {
  color: #e06c75;
}

.dark .hljs-comment,
.dark .hljs-quote {
  color: #71717a;
}

.dark .hljs-keyword,
.dark .hljs-selector-tag,
.dark .hljs-addition {
  color: #c678dd;
}

.dark .hljs-number,
.dark .hljs-string,
.dark .hljs-meta .hljs-meta-string,
.dark .hljs-literal,
.dark .hljs-doctag,
.dark .hljs-regexp {
  color: #98c379;
}

.dark .hljs-title,
.dark .hljs-section,
.dark .hljs-name,
.dark .hljs-selector-id,
.dark .hljs-selector-class {
  color: #61afef;
}

.dark .hljs-variable,
.dark .hljs-template-variable,
.dark .hljs-class .hljs-title,
.dark .hljs-type {
  color: #e5c07b;
}

.dark .hljs-tag,
.dark .hljs-symbol,
.dark .hljs-bullet,
.dark .hljs-subst,
.dark .hljs-meta,
.dark .hljs-link {
  color: #d19a66;
}

.dark .hljs-params,
.dark .hljs-attr {
  color: #d19a66;
}